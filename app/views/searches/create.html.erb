<form class="uk-form" action="/search" accept-charset="UTF-8" method="post">
	
	<%= hidden_field_tag :authenticity_token, form_authenticity_token %>
	
	<section class="search-page">
		<input type="hidden" name="search[query]" value="<%= @search.query %>">
		<div class="row">
			<div class="col-md-3 col-lg-2">
				<div class="panel-group" id="accordion1" role="tablist" aria-multiselectable="true">
					<div class="panel panel-default">
						<div class="panel-heading" role="tab" id="headingOne">
							<h4 class="panel-title">
								<a role="button" data-toggle="collapse" data-parent="#accordion1" href="#collapseOne" aria-expanded="true" aria-controls="collapseOne">
									NCM <i class="indicator glyphicon glyphicon-chevron-up  pull-right"></i>
								</a>
							</h4>
						</div>
						<div id="collapseOne" class="panel-collapse collapse in" role="tabpanel" aria-labelledby="headingOne">
							<div class="panel-body">
								<% @result.filters.select { |e| e.type == Search::SelectionFilterType::Ncm }.each do |filter| %>
									<div>
										<input type="hidden" name="filters[][hits]" value="<%= filter.hits %>">
										<input type="hidden" name="filters[][type]" value="<%= filter.type %>">
										<input type="hidden" name="filters[][value]" value="<%= filter.value %>">
										<input type="checkbox" name="filters[][selected]" <%= filter.selected ? "checked" : ""  %> value="true">
										<%= filter.value  %>
										<span class="badge">
										<%= filter.hits %></span>
									</div>
								<% end %>
							</div>
						</div>
					</div>
				</div>

				
				<div class="panel-group" id="accordion2" role="tablist" aria-multiselectable="true">
					<div class="panel panel-default">
						<div class="panel-heading" role="tab" id="headingTwo">
							<h4 class="panel-title">
								<a role="button" data-toggle="collapse" data-parent="#accordion2" href="#collapseTwo" aria-expanded="true" aria-controls="collapseTwo">
									País de origem <i class="indicator glyphicon glyphicon-chevron-up  pull-right"></i>
								</a>
							</h4>
						</div>
						<div id="collapseTwo" class="panel-collapse collapse in" role="tabpanel" aria-labelledby="headingTwo">
							<div class="panel-body">
								<% @result.filters.select { |e| e.type == Search::SelectionFilterType::CountryOrigin }.each do |filter| %>
									<div data-uk-tooltip="{pos:'top-left'}" title="<%= filter.value %>">
										<input type="hidden" name="filters[][hits]" value="<%= filter.hits %>">
										<input type="hidden" name="filters[][type]" value="<%= filter.type %>">
										<input type="hidden" name="filters[][value]" value="<%= filter.value %>">
										<input type="checkbox" name="filters[][selected]" <%= filter.selected ? "checked" : ""  %> value="true">
									    <img class="flag flag-<%= filter.value.downcase %>" data-toggle="tooltip" data-placement="bottom" />
										<span class="badge">
											<%= filter.hits %></span>
									</div>
								<% end %>
							</div>
						</div>
					</div>
				</div>

				<div class="panel-group" id="accordion3" role="tablist" aria-multiselectable="true">
					<div class="panel panel-default">
						<div class="panel-heading" role="tab" id="headingThree">
							<h4 class="panel-title">
								<a role="button" data-toggle="collapse" data-parent="#accordion3" href="#collapseThree" aria-expanded="true" aria-controls="collapseThree">
									País de Aquisição <i class="indicator glyphicon glyphicon-chevron-up  pull-right"></i>
								</a>
							</h4>
						</div>
						<div id="collapseThree" class="panel-collapse collapse in" role="tabpanel" aria-labelledby="headingThree">
							<div class="panel-body">
								<% @result.filters.select { |e| e.type == Search::SelectionFilterType::CountryAquisition }.each do |filter| %>
									<div data-uk-tooltip="{pos:'top-left'}" title="<%= filter.value %>">
										<input type="hidden" name="filters[][hits]" value="<%= filter.hits %>">
										<input type="hidden" name="filters[][type]" value="<%= filter.type %>">
										<input type="hidden" name="filters[][value]" value="<%= filter.value %>">
										<input type="checkbox" name="filters[][selected]" <%= filter.selected ? "checked" : ""  %> value="true">
									    <img class="flag flag-<%= filter.value.downcase %>" data-toggle="tooltip" data-placement="bottom" />
										<span class="badge">
											<%= filter.hits %></span>
									</div>
								<% end %>
							</div>
						</div>
					</div>
				</div>


				<div class="panel-group" id="accordion4" role="tablist" aria-multiselectable="true">
					<div class="panel panel-default">
						<div class="panel-heading" role="tab" id="headingFour">
							<h4 class="panel-title">
								<a role="button" data-toggle="collapse" data-parent="#accordion4" href="#collapseFour" aria-expanded="true" aria-controls="collapseFour">
									Valor total <i class="indicator glyphicon glyphicon-chevron-up  pull-right"></i>
								</a>
							</h4>
						</div>

						<div id="collapseFour" class="panel-collapse collapse in" role="tabpanel" aria-labelledby="headingFour">

							<div class="panel-body">

							<% if @result.range_filters[Search::RangeFilterType::TotalValue.to_s] != nil %>
								<input type="hidden" name="range_filters[<%= Search::RangeFilterType::TotalValue %>][min]" value="<%= @result.range_filters[Search::RangeFilterType::TotalValue.to_s].min %>">

							  <input type="hidden" name="range_filters[<%= Search::RangeFilterType::TotalValue.to_s %>][max]" value="<%= @result.range_filters[Search::RangeFilterType::TotalValue.to_s].max %>">

							  <input type="hidden" name="range_filters[<%= Search::RangeFilterType::TotalValue.to_s %>][min_range]" value="<%= @result.range_filters[Search::RangeFilterType::TotalValue.to_s].min_range %>">

							  <input type="hidden" name="range_filters[<%= Search::RangeFilterType::TotalValue.to_s %>][max_range]" value="<%= @result.range_filters[Search::RangeFilterType::TotalValue.to_s].max_range %>">

							  <input type="text" id="amount" readonly style="text-align:center;font-weight:bold;margin-top:0px !important;">

						      <div id="total-value-slider" 
						      		class="slider-range"  
						      		data-min-range="<%= @result.range_filters[Search::RangeFilterType::TotalValue.to_s].min_range %>" 
						      		data-max-range="<%= @result.range_filters[Search::RangeFilterType::TotalValue.to_s].max_range %>" 
						      		data-min="<%= @result.range_filters[Search::RangeFilterType::TotalValue.to_s].min %>" 
						      		data-max="<%= @result.range_filters[Search::RangeFilterType::TotalValue.to_s].max %>" 
						      		data-max-field="input[name='range_filters[<%= Search::RangeFilterType::TotalValue.to_s %>][max]']" 
						      		data-min-field="input[name='range_filters[<%= Search::RangeFilterType::TotalValue.to_s %>][min]']" 
						      		data-display="#amount" 
						      		data-display-prefix="$">
						      </div>
						      <input class="uk-button uk-button-mini pull-right" type="submit" value="Aplicar" />

						      		<% else %>
						      			<%= @result.range_filters %>
						      		<% end %>

							</div>

						</div>
					</div>
				</div>



				<div class="panel-group" id="accordion5" role="tablist" aria-multiselectable="true">
					<div class="panel panel-default">
						<div class="panel-heading" role="tab" id="headingFive">
							<h4 class="panel-title">
								<a role="button" data-toggle="collapse" data-parent="#accordion5" href="#collapseFive" aria-expanded="true" aria-controls="collapseFive">
									Valor unitário <i class="indicator glyphicon glyphicon-chevron-up  pull-right"></i>
								</a>
							</h4>
						</div>

						<div id="collapseFive" class="panel-collapse collapse in" role="tabpanel" aria-labelledby="headingFive">

							<div class="panel-body">

							<% if @result.range_filters[Search::RangeFilterType::UnityValue.to_s] != nil %>
								<input type="hidden" name="range_filters[<%= Search::RangeFilterType::UnityValue %>][min]" value="<%= @result.range_filters[Search::RangeFilterType::UnityValue.to_s].min %>">

							  <input type="hidden" name="range_filters[<%= Search::RangeFilterType::UnityValue.to_s %>][max]" value="<%= @result.range_filters[Search::RangeFilterType::UnityValue.to_s].max %>">

							  <input type="hidden" name="range_filters[<%= Search::RangeFilterType::UnityValue.to_s %>][min_range]" value="<%= @result.range_filters[Search::RangeFilterType::UnityValue.to_s].min_range %>">

							  <input type="hidden" name="range_filters[<%= Search::RangeFilterType::UnityValue.to_s %>][max_range]" value="<%= @result.range_filters[Search::RangeFilterType::UnityValue.to_s].max_range %>">

							  <input type="text" id="amount-unity" readonly style="text-align:center;font-weight:bold;margin-top:0px !important;">

						      <div id="total-value-slider" 
						      		class="slider-range"  
						      		data-min-range="<%= @result.range_filters[Search::RangeFilterType::UnityValue.to_s].min_range %>" 
						      		data-max-range="<%= @result.range_filters[Search::RangeFilterType::UnityValue.to_s].max_range %>" 
						      		data-min="<%= @result.range_filters[Search::RangeFilterType::UnityValue.to_s].min %>" 
						      		data-max="<%= @result.range_filters[Search::RangeFilterType::UnityValue.to_s].max %>" 
						      		data-max-field="input[name='range_filters[<%= Search::RangeFilterType::UnityValue.to_s %>][max]']" 
						      		data-min-field="input[name='range_filters[<%= Search::RangeFilterType::UnityValue.to_s %>][min]']" 
						      		data-display="#amount-unity" 
						      		data-display-prefix="$">
						      </div>
						      <input class="uk-button uk-button-mini pull-right" type="submit" value="Aplicar" />

						      		<% else %>
						      			<%= @result.range_filters %>
						      		<% end %>

							</div>

						</div>
					</div>
				</div>

				<div class="panel-group" id="accordion6" role="tablist" aria-multiselectable="true">
					<div class="panel panel-default">
						<div class="panel-heading" role="tab" id="headingSix">
							<h4 class="panel-title">
								<a role="button" data-toggle="collapse" data-parent="#accordion6" href="#collapseSix" aria-expanded="true" aria-controls="collapseSix">
									Quantidade Comercializada <i class="indicator glyphicon glyphicon-chevron-up  pull-right"></i>
								</a>
							</h4>
						</div>

						<div id="collapseSix" class="panel-collapse collapse in" role="tabpanel" aria-labelledby="headingSix">

							<div class="panel-body">

							<% if @result.range_filters[Search::RangeFilterType::Quantity.to_s] != nil %>
								<input type="hidden" name="range_filters[<%= Search::RangeFilterType::Quantity %>][min]" value="<%= @result.range_filters[Search::RangeFilterType::Quantity.to_s].min %>">

							  <input type="hidden" name="range_filters[<%= Search::RangeFilterType::Quantity.to_s %>][max]" value="<%= @result.range_filters[Search::RangeFilterType::Quantity.to_s].max %>">

							  <input type="hidden" name="range_filters[<%= Search::RangeFilterType::Quantity.to_s %>][min_range]" value="<%= @result.range_filters[Search::RangeFilterType::Quantity.to_s].min_range %>">

							  <input type="hidden" name="range_filters[<%= Search::RangeFilterType::Quantity.to_s %>][max_range]" value="<%= @result.range_filters[Search::RangeFilterType::Quantity.to_s].max_range %>">

							  <input type="text" id="amount-quantity" readonly style="text-align:center;font-weight:bold;margin-top:0px !important;">

						      <div id="total-value-slider" 
						      		class="slider-range"  
						      		data-min-range="<%= @result.range_filters[Search::RangeFilterType::Quantity.to_s].min_range %>" 
						      		data-max-range="<%= @result.range_filters[Search::RangeFilterType::Quantity.to_s].max_range %>" 
						      		data-min="<%= @result.range_filters[Search::RangeFilterType::Quantity.to_s].min %>" 
						      		data-max="<%= @result.range_filters[Search::RangeFilterType::Quantity.to_s].max %>" 
						      		data-max-field="input[name='range_filters[<%= Search::RangeFilterType::Quantity.to_s %>][max]']" 
						      		data-min-field="input[name='range_filters[<%= Search::RangeFilterType::Quantity.to_s %>][min]']" 
									data-display="#amount-quantity"
									data-display-prefix="un. " >
						      </div>
						      <input class="uk-button uk-button-mini pull-right" type="submit" value="Aplicar" />

						      		<% else %>
						      			<%= @result.range_filters %>
						      		<% end %>

							</div>

						</div>



					</div>
				</div>


				<div class="panel-group" id="accordion7" role="tablist" aria-multiselectable="true">
					<div class="panel panel-default">
						<div class="panel-heading" role="tab" id="headingSeven">
							<h4 class="panel-title">
								<a role="button" data-toggle="collapse" data-parent="#accordion7" href="#collapseSeven" aria-expanded="true" aria-controls="collapseSeven">
									Quantidade Aduaneira <i class="indicator glyphicon glyphicon-chevron-up  pull-right"></i>
								</a>
							</h4>
						</div>

						<div id="collapseSeven" class="panel-collapse collapse in" role="tabpanel" aria-labelledby="headingSeven">

							<div class="panel-body">

							<% if @result.range_filters[Search::RangeFilterType::Customs.to_s] != nil %>
								<input type="hidden" name="range_filters[<%= Search::RangeFilterType::Customs %>][min]" value="<%= @result.range_filters[Search::RangeFilterType::Customs.to_s].min %>">

							  <input type="hidden" name="range_filters[<%= Search::RangeFilterType::Customs.to_s %>][max]" value="<%= @result.range_filters[Search::RangeFilterType::Customs.to_s].max %>">

							  <input type="hidden" name="range_filters[<%= Search::RangeFilterType::Customs.to_s %>][min_range]" value="<%= @result.range_filters[Search::RangeFilterType::Customs.to_s].min_range %>">

							  <input type="hidden" name="range_filters[<%= Search::RangeFilterType::Customs.to_s %>][max_range]" value="<%= @result.range_filters[Search::RangeFilterType::Customs.to_s].max_range %>">

							  <input type="text" id="amount-Customs" readonly style="text-align:center;font-weight:bold;margin-top:0px !important;">

						      <div id="total-value-slider" 
						      		class="slider-range"  
						      		data-min-range="<%= @result.range_filters[Search::RangeFilterType::Customs.to_s].min_range %>" 
						      		data-max-range="<%= @result.range_filters[Search::RangeFilterType::Customs.to_s].max_range %>" 
						      		data-min="<%= @result.range_filters[Search::RangeFilterType::Customs.to_s].min %>" 
						      		data-max="<%= @result.range_filters[Search::RangeFilterType::Customs.to_s].max %>" 
						      		data-max-field="input[name='range_filters[<%= Search::RangeFilterType::Customs.to_s %>][max]']" 
						      		data-min-field="input[name='range_filters[<%= Search::RangeFilterType::Customs.to_s %>][min]']" 
									data-display="#amount-Customs"
									data-display-prefix="un. " >
						      </div>
						      <input class="uk-button uk-button-mini pull-right" type="submit" value="Aplicar" />

						      		<% else %>
						      			<%= @result.range_filters %>
						      		<% end %>

							</div>

						</div>

					</div>
				</div>



			</div>

			<div class="col-md-9 col-lg-10">
				<%  if @result.products.count == 0 %>
				<div class="bs-docs" data-content="404">
					<h1>Não existem resultados para os valores pesquisados!</h1>
				</div>
				<% else %>
				<div class="bs-result">
					<div class="row">
						<div class="col-md-5">
							<p>
								Buscando por&nbsp;<span><%= @search.query %>,</span> total <%= @result.hits %> hits.
							</p>
						</div>
						<div class="col-md-5">
							<p>Total US<%= number_to_currency(@result.cif_total) %></p>
						</div>
						<div class="col-md-2">
							<select name="order" class="form-control">
								<option>Sort by:</option>
								<option>aa</option>
								<option>aa</option>
							</select>
						</div>
					</div>
				</div>
				<% @result.products.each do |product| %>
				<div class="bs-docs col-md-6 col-sm-12 col-lg-4" data-content="<%= product["mes_ano"] %>
					">
					<div class="row">
						<div class="col-md-6">
							<div class="row">
								<div class="col-md-5">
									<div>
										<span data-uk-tooltip title="ORIGEM : <%= product["paisOrigem"] %>">
											<img class="flag flag-<%= product["siglaPaisOrigem"].downcase %>" data-toggle="tooltip"  data-placement="bottom" />
										</span>
										<span data-uk-tooltip title="AQUISIÇÃO : <%= product["paisAquisicao"] %>">
										<img class="flag flag-<%= product["siglaPaisAquisicao"].downcase %>" data-toggle="tooltip" data-placement="bottom" />
										</span>
									</div>
								</div>
								<div class="col-md-7">
									<span><%= product["ncm"] %></span>
								</div>
							</div>
							<div class="row">
								<div class="col-md-12">
									<div>
										<p><%= product["descricao_detalhada_produto"].truncate(95, separator: /\s/) %></p>
									</div>
								</div>
							</div>

						</div>

						<div class="col-md-5 cif">
						<!--
							<div>
								<span>FOB / CIF Unit.</span>
								<span style=""><%= number_to_currency(product["valor_unidade_produto_dolar"]) %> /	<%= product["vl_ift"] %></span>
							</div>
							<div>
								<span>CIF Total</span>
								<span>
									<%= number_to_currency(product["CIF"]) %></span>
							</div>
							quantidade_comercializada_produto
							-->
							<div>
							<span><strong><%= product["quantidade_comercializada_produto"] %> </strong><span>PEÇAS</span></span>
							<span><strong><%= number_to_currency(product["vl_ift"]) %></strong><span>FOB UNIT.</span></span>
							<span><strong><%= number_to_currency(product["CIF"]) %></strong><span>CIF TOTAL</span></span>
							</div>
						</div>

					</div>
				</div>
				<% end %>
				<% end %></div>
		</div>
	</section>
</form>
